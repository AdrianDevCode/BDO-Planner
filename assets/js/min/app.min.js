/*
* @Author: SirMrE
* @http: http://www.sirmre.com/bdo-calculator
* @Copyright: (c) 2016 Mark Eliasen
* @license: May be freely distributed under the CC BY-NC 3.0 License 
*           (https://creativecommons.org/licenses/by-nc/3.0/)
* @Date:   2016-04-07 20:53:22
* @Last Modified by:   SirMrE
* @Last Modified time: 2016-04-10 10:52:46
*/
!function($){"use strict";function a(a){return"[object Array]"===Object.prototype.toString.call(a)}function t(t,e,n,c){n="function"==typeof n?n:function(){},c="undefined"==typeof c?"":c;var l=[];if(a(e))l=e;else for(var r in e)e.hasOwnProperty(r)&&l.push(r);"string"==typeof t&&(t=$(t)),t.select2({width:"100%",data:"undefined"==typeof t.attr("placeholder")?l:[t.attr("placeholder")].concat(l)}),n()}function e(a,e){var n=Object.keys(a.enhancement).length;0===n?e.val("0").trigger("change").prop("disabled",!0):(e.prop("disabled",!1),$(e)[0].childElementCount-1!==n&&(e.select2("destroy").html(""),n>BDOdatabase.max_gear_enhancement&&(n=BDOdatabase.max_gear_enhancement),t(e,Array.apply(null,{length:n+1}).map(Number.call,Number))))}var n="";$(document).ready(function(){t("#player-class",BDOdatabase.classes,function(){$("#player-class-section").slideDown()}),$("#player-class").on("change",function(){var a=$("#calculator-section select").length-1;n=$(this).val().toLowerCase(),$(this).slideUp("fast",function(){$("#calculator-section select").each(function(e,c){var l=$(c),r,o;l.parent("div").hasClass("enhancement")?t(l,Array.apply(null,{length:(-1===$.inArray(l.attr("data-type"),["rings","earrings","belt","necklace"])?BDOdatabase.max_gear_enhancement:BDOdatabase.max_acc_enhancement)+1}).map(Number.call,Number)):(o=BDOdatabase.items[l.attr("data-itemset")],r="undefined"==typeof o[n]?o:o[n],"undefined"!=typeof o.all&&(r=r.concat(o.all)),t(l,r)),a===e&&(BDOcalculator.init(),BDOcalculator.calculate(),$("#calculator-section").slideDown("fast"))})})}),$("#calculator-section div:not(.enhancement) > select").on("change",function(){var a=BDOdatabase.items[$(this).attr("data-itemset")],t=$(this).attr("data-type"),c=$(this).attr("data-item");-1!==$.inArray(t,["main-weapon","secondary-weapon"])&&(a=a[n.toLowerCase()]),a=a[$(this).val()],e(a,$('div.enhancement select[data-type="'+t+'"]'+("undefined"!=typeof c?'[data-item="'+c+'"]':""))),BDOcalculator.setGear(a,t,c,0,function(){BDOcalculator.calculate()})}),$("#calculator-section div.enhancement > select").on("change",function(){var a=$(this).val(),t=$(this).attr("data-type"),e=$(this).attr("data-item");BDOcalculator.setEnchantmentLevel(t,e,a,function(){BDOcalculator.calculate()})})})}(jQuery);